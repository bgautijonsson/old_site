[
  {
    "objectID": "posts/lanategundir/index.html",
    "href": "posts/lanategundir/index.html",
    "title": "Dreifing húsnæðislánategunda hjá íslenskum heimilum",
    "section": "",
    "text": "Í nýjustu útgáfu af Fjármálastöðugleika birti Seðlabankinn tölur yfir hlutfall lánategunda hjá íslenskum heimilum. Ég hafði verið að spjalla við Ingva og Arnar hjá Pyngjunni um þessi gögn þ.a. ég útbjó snöggvast gagnvirka HTML skýrslu með Quarto í RStudio og sendi á kauðana.\nMyndirnar hér eru teiknaðar með blöndu af ggplot2 og plotly. Hreyfið músina yfir stöplana til að sjá merkingar (hlutföll, tegund lána eða tegund vaxta). Þið getið smellt á code flipana til að sjá undirliggjandi kóðann á bakvið skýrsluna. Kóðann í heild sinni má svo finna á githubinu mínu.\nSvo er lítið mál að uppfæra slíkar skýrslur sjálfkrafa ef slóðin að gögnum sem eru notuð og uppsetning þeirra helst óbreytt.\n\nAllar undirtegundirTegund vaxtaTegund lánsMánaðarleg breyting\n\n\n\n\nCode\np <- d |> \n    mutate(dags = as_date(dags),\n           value = value / 100,\n           text = str_c(\"Dagsetning: \", dags, \"\\n\",\n                        \"Tegund láns: \", tegund1, \"\\n\",\n                        \"Tegund vaxta: \", str_to_title(tegund2), \"\\n\",\n                        \"Hlutfall: \", percent(value))) |> \n    ggplot(aes(dags, value, text = text)) +\n    geom_col(aes(fill = paste(tegund1, \"og\", tegund2)), position = \"stack\") +\n    scale_x_date(date_labels = \"%m/%y\",\n                 expand = expansion()) +\n    scale_y_continuous(labels = label_percent(big.mark = \".\",\n                                              decimal.mark = \",\"),\n                       breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1),\n                       expand = expansion()) +\n    scale_fill_brewer(type = \"qual\", palette = \"Set1\") +\n    theme_half_open() +\n    theme(legend.position = \"none\",\n          axis.text = element_text(size = 10)) +\n    labs(x = NULL,\n         y = NULL,\n         fill = NULL,\n         title = \"Dreifing húsnæðislánategunda heimila\")\n\nggsave(plot = p + \n           theme(legend.position = \"top\", legend.text = element_text(size = 11)), \n       filename = \"dreifing.png\",\n       width = 8, height = 0.5 * 8, scale = 1.3, bg = \"white\")\n\nggplotly(p, tooltip = \"text\")\n\n\n\n\n\n\n\n\n\n\nCode\np <- d |> \n    mutate(dags = as_date(dags),\n           value = value / 100) |> \n    group_by(dags, tegund2) |> \n    summarise(value = sum(value),\n              .groups = \"drop\") |> \n    mutate(text = str_c(\"Dagsetning: \", dags, \"\\n\",\n                        \"Tegund láns: \", \"Heild\", \"\\n\",\n                        \"Tegund vaxta: \", str_to_title(tegund2), \"\\n\",\n                        \"Hlutfall: \", percent(value))) |> \n    ggplot(aes(dags, value, text = text)) +\n    geom_col(aes(fill = paste(tegund2)), position = \"stack\") +\n    scale_x_date(date_labels = \"%m/%y\",\n                 expand = expansion()) +\n    scale_y_continuous(labels = label_percent(big.mark = \".\",\n                                              decimal.mark = \",\"),\n                       breaks = c(0, 1),\n                       expand = expansion()) +\n    scale_fill_brewer(type = \"qual\", palette = \"Set1\") +\n    theme_half_open() +\n    theme(legend.position = \"none\",\n          axis.text = element_text(size = 10)) +\n    labs(x = NULL,\n         y = NULL,\n         title = \"Dreifing vaxtategunda heimila\")\n\nggplotly(p, tooltip = \"text\")\n\n\n\n\n\n\n\n\n\n\nCode\np <- d |> \n    mutate(dags = as_date(dags)) |> \n    group_by(dags, tegund1) |> \n    summarise(value = sum(value/100),\n              .groups = \"drop\") |> \n    mutate(text = str_c(\"Dagsetning: \", dags, \"\\n\",\n                        \"Tegund láns: \", tegund1, \"\\n\",\n                        \"Tegund vaxta: \", \"Heild\", \"\\n\",\n                        \"Hlutfall: \", percent(value))) |> \n    ggplot(aes(dags, value, text = text)) +\n    geom_col(aes(fill = paste(tegund1)), position = \"stack\") +\n    scale_x_date(date_labels = \"%m/%y\",\n                 expand = expansion()) +\n    scale_y_continuous(labels = label_percent(big.mark = \".\",\n                                              decimal.mark = \",\"),\n                       breaks = c(0, 1),\n                       expand = expansion()) +\n    scale_fill_brewer(type = \"qual\", palette = \"Set1\") +\n    theme_half_open() +\n    theme(legend.position = \"none\",\n          axis.text = element_text(size = 10)) +\n    labs(x = NULL,\n         y = NULL,\n         title = \"Dreifing lánategunda heimila\")\n\nggplotly(p, tooltip = \"text\")\n\n\n\n\n\n\n\n\n\n\nCode\nplot_dat <- d |> \n    bind_rows(\n        d |> \n            mutate(tegund1 = \"Heild\") |> \n            group_by(dags, tegund1, tegund2) |> \n            summarise(value = sum(value),\n                      .groups = \"drop\")\n    ) |> \n    bind_rows(\n        d |> \n            mutate(tegund2 = \"Heild\") |> \n            group_by(dags, tegund1, tegund2) |> \n            summarise(value = sum(value),\n                      .groups = \"drop\")\n    ) |> \n    mutate(name = str_c(tegund1, \" og \", tegund2),\n           dags = as_date(dags),\n           tegund2 = str_to_sentence(tegund2)) |> \n    group_by(name) |> \n    mutate(breyting = c(0, diff(value))/100) |> \n    ungroup() |> \n    mutate(text = str_c(\"Dagsetning: \", dags, \"\\n\",\n                        \"Tegund láns: \", tegund1, \"\\n\",\n                        \"Tegund vaxta: \", str_to_title(tegund2), \"\\n\",\n                        \"Breyting: \", percent(breyting, suffix = \"%-stig\")))\n\n\np <- plot_dat |> \n    ggplot(aes(dags, breyting, text = text)) +\n    geom_col(data = plot_dat |> \n                 rename(t1 = tegund1, t2 = tegund2, nm = name) |> \n                 filter(t1 != \"Heild\", t2 != \"Heild\"),\n             position = \"stack\", fill = \"grey80\", width = 28) +\n    geom_col(aes(fill = name), position = \"stack\", width = 28) +\n    geom_hline(yintercept = 0, lty = 2) +\n    scale_x_date(date_labels = \"%m/%y\") +\n    scale_y_continuous(labels = label_percent(suffix = \"%-stig\",\n                                              big.mark = \".\",\n                                              decimal.mark = \",\"),\n                       breaks = c(-0.04, -0.02, 0, 0.02, 0.04)) +\n    scale_fill_brewer(type = \"qual\", palette = \"Set1\") +\n    facet_grid(tegund2 ~ tegund1) +\n    theme_half_open() +\n    theme(legend.position = \"none\",\n          axis.text = element_text(size = 10)) +\n    labs(x = NULL,\n         y = NULL,\n         title = \"Mánaðarleg breyting á húsnæðislánategundum heimila\")\n\nggsave(plot = p, filename = \"manbreyting.png\",\n       width = 8, height = 0.7 * 8, scale = 1.3, bg = \"white\")\n\nggplotly(p, tooltip = \"text\")"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Færslur",
    "section": "",
    "text": "Dæmi um notkun Quarto og RStudio til að útbúa gagnvirkar HTML skýrslur\n\n\n\n\nefnahagur\n\n\nR\n\n\n\n\n\n\n\n\n\n\n\nJun 23, 2022\n\n\nBrynjólfur Gauti Guðrúnar Jónsson\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Brynjólfur Gauti Guðrúnar Jónsson",
    "section": "",
    "text": "Auk þessa kenni ég Tölfræðiráðgjöf og vinn hjá Hjartavernd."
  }
]